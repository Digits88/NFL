<!-- 
    Author: Mike Newell Â© 2012
-->
<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html>
    <head>
        <title>Instagram API Prototype</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="stylesheet" type="text/css" href="css/style.css" />
    </head>
    <body>
        <div id="wrap">
            
        </div>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="../javascripts/jquery.min.js">\x3C/script>')</script>
        <script>
            //https://api.instagram.com/v1/tags/snow/media/recent?access_token=231409256.05e13af.c3f64f166e634b1c967cc819f12061d9
            
            (function() {
                $(window).load(function() {
                    
                    var Instagram = function(access_token) {
                        
                        var _access_token;
                        
                        var init = function() {
                            
                            _access_token = access_token;
                            
                            window.addEventListener('newPhotos', photosLoaded, false);
                            
                            getNewPhotos();
                        };
                        
                        var getNewPhotos = function() {
                            $.ajax({
                                url: 'https://api.instagram.com/v1/tags/snow/media/recent?access_token=' + _access_token,
                                type: 'GET',
                                dataType: 'jsonp',
                                success: function(data) {
    //                                console.log('data returned')
    //                                console.dir(data);

                                    var evt = new CustomEvent('newPhotos', {
                                        detail: data
                                    });
                                    window.dispatchEvent(evt);
                                }
                            });
                        };
                        
                        var photosLoaded = function(evt) {
                            console.log('custom event dispatched')
                            outputImages(evt.detail.data);
                            setTimeout(function() {
                                getNewPhotos();
                            }, 15000);
                        };
                        
                        var outputImages = function(data) {
                            $(data).each(function(idx) {
                                
                                console.log(data)
                                
                                var imageURL = data[idx].images.standard_resolution.url;
                                
                                $('#wrap').append('<img src="'+imageURL+'" />');
                            });
                        };
                        
                        init();
                    };
                    
                    var instagram = new Instagram('231409256.05e13af.c3f64f166e634b1c967cc819f12061d9');
                    
                });
            })(jQuery);
            
        </script>
    </body>
</html>
